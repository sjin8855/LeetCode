SELECT CUSTOMER_ID, COUNT(*) as COUNT_NO_TRANS
FROM (SELECT CUSTOMER_ID
        FROM VISITS
        WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)) S
GROUP BY CUSTOMER_ID